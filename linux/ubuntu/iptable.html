<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>IPTable - cysec-all-in-one(A.R)</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../favicon.svg">
        <link rel="shortcut icon" href="../../favicon.png">
        <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
        <link rel="stylesheet" href="../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../../AboutMe.html"><strong aria-hidden="true">1.</strong> AboutMe</a></li><li class="chapter-item expanded "><a href="../../INTRO.html"><strong aria-hidden="true">2.</strong> Introductory</a></li><li class="chapter-item expanded "><a href="../../threats/threats.html"><strong aria-hidden="true">3.</strong> Threats</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="../../webapp/webapp.html"><strong aria-hidden="true">4.</strong> WebApplication</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../webapp/owasp.html"><strong aria-hidden="true">4.1.</strong> OWASP</a></li><li class="chapter-item "><a href="../../webapp/objects.html"><strong aria-hidden="true">4.2.</strong> Objects</a></li><li class="chapter-item "><a href="../../webapp/cors.html"><strong aria-hidden="true">4.3.</strong> CORS</a></li><li class="chapter-item "><a href="../../webapp/api.html"><strong aria-hidden="true">4.4.</strong> APIs</a></li><li class="chapter-item "><a href="../../webapp/ssr.html"><strong aria-hidden="true">4.5.</strong> SSR</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../scan/scan.html"><strong aria-hidden="true">5.</strong> Scan</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../scan/acunetix.html"><strong aria-hidden="true">5.1.</strong> acunetix</a></li></ol></li><li class="chapter-item expanded "><a href="../../audit/audit.html"><strong aria-hidden="true">6.</strong> Audit</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../audit/nmap.html"><strong aria-hidden="true">6.1.</strong> nmap</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../identification.html"><strong aria-hidden="true">7.</strong> Identification</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../identification/accessibility/accessibility.html"><strong aria-hidden="true">7.1.</strong> Accessibility</a></li><li class="chapter-item "><a href="../../identification/authentication/authentication.html"><strong aria-hidden="true">7.2.</strong> Authentication</a></li><li class="chapter-item "><a href="../../identification/authorization/authorization.html"><strong aria-hidden="true">7.3.</strong> Authorization</a></li></ol></li><li class="chapter-item expanded "><a href="../../environment/environment.html"><strong aria-hidden="true">8.</strong> Environment</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../environment/kioptrix.html"><strong aria-hidden="true">8.1.</strong> Kioptrix</a></li></ol></li><li class="chapter-item expanded "><a href="../../network/network.html"><strong aria-hidden="true">9.</strong> Network</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../network/dns.html"><strong aria-hidden="true">9.1.</strong> DNS</a></li><li class="chapter-item "><a href="../../network/firewall.html"><strong aria-hidden="true">9.2.</strong> Firewall</a></li><li class="chapter-item "><a href="../../network/ids-ips.html"><strong aria-hidden="true">9.3.</strong> IDSIPS</a></li><li class="chapter-item "><a href="../../network/proxy.html"><strong aria-hidden="true">9.4.</strong> Proxy</a></li><li class="chapter-item "><a href="../../network/vpn.html"><strong aria-hidden="true">9.5.</strong> VPN</a></li><li class="chapter-item "><a href="../../network/tools.html"><strong aria-hidden="true">9.6.</strong> Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../network/tools/troubleshooting/tools-troubleshooting.html"><strong aria-hidden="true">9.6.1.</strong> Troubleshooting</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../network/tools/troubleshooting/WIRESHARK.html"><strong aria-hidden="true">9.6.1.1.</strong> WIRESHARK</a></li></ol></li><li class="chapter-item "><a href="../../network/tools/wireshark.html"><strong aria-hidden="true">9.6.2.</strong> wireshark</a></li><li class="chapter-item "><a href="../../network/tools/snmp.html"><strong aria-hidden="true">9.6.3.</strong> Smnp</a></li><li class="chapter-item "><a href="../../network/tools/onesixtyone.html"><strong aria-hidden="true">9.6.4.</strong> OneSixOne</a></li></ol></li><li class="chapter-item "><a href="../../network/wireless.html"><strong aria-hidden="true">9.7.</strong> Wireless</a></li></ol></li><li class="chapter-item expanded "><a href="../../cryptography/cryptography.html"><strong aria-hidden="true">10.</strong> Cryptography</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../cryptography/token.html"><strong aria-hidden="true">10.1.</strong> Token</a></li><li class="chapter-item "><a href="../../cryptography/pki.html"><strong aria-hidden="true">10.2.</strong> PKI</a></li></ol></li><li class="chapter-item expanded "><a href="../../data/data.html"><strong aria-hidden="true">11.</strong> Data</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../data/bcdr.html"><strong aria-hidden="true">11.1.</strong> BCDR</a></li><li class="chapter-item "><a href="../../data/raid.html"><strong aria-hidden="true">11.2.</strong> Raid</a></li><li class="chapter-item "><a href="../../data/tools-bck.html"><strong aria-hidden="true">11.3.</strong> Tools</a></li></ol></li><li class="chapter-item expanded "><a href="../../searchengine/searchengine.html"><strong aria-hidden="true">12.</strong> SearchEngine</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../searchengine/shodanhq.html"><strong aria-hidden="true">12.1.</strong> ShodanHQ</a></li></ol></li><li class="chapter-item expanded "><a href="../../database/database.html"><strong aria-hidden="true">13.</strong> Databases</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../database/google.html"><strong aria-hidden="true">13.1.</strong> Google</a></li></ol></li><li class="chapter-item expanded "><a href="../../malware/malware.html"><strong aria-hidden="true">14.</strong> Malware</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../malware/anti-malware.html"><strong aria-hidden="true">14.1.</strong> AntiMalware</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../malware/tools.html"><strong aria-hidden="true">14.1.1.</strong> Tools</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../backtrack/backtrack.html"><strong aria-hidden="true">15.</strong> BackTrack</a></li><li class="chapter-item expanded "><a href="../../penetrationtest/penetrationtest.html"><strong aria-hidden="true">16.</strong> PenetrationTest</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../penetrationtest/penetrationtest-tools/penetrationtest-tools.html"><strong aria-hidden="true">16.1.</strong> Tools</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../penetrationtest/penetrationtest-tools/metasploit.html"><strong aria-hidden="true">16.1.1.</strong> Metasploit</a></li><li class="chapter-item "><a href="../../penetrationtest/penetrationtest-tools/lynis.html"><strong aria-hidden="true">16.1.2.</strong> Lynis</a></li><li class="chapter-item "><a href="../../penetrationtest/penetrationtest-tools/scanPBNJ.html"><strong aria-hidden="true">16.1.3.</strong> scanPBNJ</a></li><li class="spacer"></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../linux/linux.html"><strong aria-hidden="true">17.</strong> Linux</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../linux/kali/kali.html"><strong aria-hidden="true">17.1.</strong> Kali</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../linux/kali/tools.html"><strong aria-hidden="true">17.1.1.</strong> Tools</a></li></ol></li><li class="chapter-item expanded "><a href="../../linux/ubuntu/ubuntu.html"><strong aria-hidden="true">17.2.</strong> Ubuntu</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../linux/ubuntu/service.html"><strong aria-hidden="true">17.2.1.</strong> Service</a></li><li class="chapter-item expanded "><a href="../../linux/ubuntu/network.html"><strong aria-hidden="true">17.2.2.</strong> Network</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../linux/ubuntu/iptable.html" class="active"><strong aria-hidden="true">17.2.2.1.</strong> IPTable</a></li></ol></li><li class="chapter-item "><a href="../../linux/ubuntu/os.html"><strong aria-hidden="true">17.2.3.</strong> OS</a></li><li class="chapter-item "><a href="../../linux/ubuntu/log.html"><strong aria-hidden="true">17.2.4.</strong> Logger</a></li><li class="chapter-item "><a href="../../linux/ubuntu/user-management/user-management.html"><strong aria-hidden="true">17.2.5.</strong> UserManagement</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../linux/ubuntu/user-management/user.html"><strong aria-hidden="true">17.2.5.1.</strong> User</a></li><li class="chapter-item "><a href="../../linux/ubuntu/user-management/pam.html"><strong aria-hidden="true">17.2.5.2.</strong> PAM</a></li><li class="chapter-item "><a href="../../linux/ubuntu/user-management/fail2ban.html"><strong aria-hidden="true">17.2.5.3.</strong> Fail2ban</a></li></ol></li><li class="chapter-item "><a href="../../linux/ubuntu/lvm.html"><strong aria-hidden="true">17.2.6.</strong> LVM</a></li><li class="chapter-item "><a href="../../linux/ubuntu/fs.html"><strong aria-hidden="true">17.2.7.</strong> FileSystem</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../protocols/protocols.html"><strong aria-hidden="true">18.</strong> Protocols</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../protocols/ssh.html"><strong aria-hidden="true">18.1.</strong> SSH</a></li><li class="chapter-item "><a href="../../protocols/ssl.html"><strong aria-hidden="true">18.2.</strong> SSL</a></li><li class="chapter-item "><a href="../../protocols/icmp.html"><strong aria-hidden="true">18.3.</strong> ICMP</a></li><li class="chapter-item "><a href="../../protocols/arp.html"><strong aria-hidden="true">18.4.</strong> ARP</a></li><li class="chapter-item "><a href="../../protocols/igmp.html"><strong aria-hidden="true">18.5.</strong> IGMP</a></li><li class="chapter-item "><a href="../../protocols/smb.html"><strong aria-hidden="true">18.6.</strong> SMB</a></li></ol></li><li class="chapter-item expanded "><a href="../../windows/windows.html"><strong aria-hidden="true">19.</strong> Windows</a></li><li class="chapter-item expanded "><a href="../../linux/opensuse/opensuse.html"><strong aria-hidden="true">20.</strong> OpenSuse</a></li><li class="chapter-item expanded "><a href="../../docker/docker.html"><strong aria-hidden="true">21.</strong> Docker</a></li><li class="chapter-item expanded "><a href="../../git/git.html"><strong aria-hidden="true">22.</strong> Git</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="../../frameworks/frameworks.html"><strong aria-hidden="true">23.</strong> Frameworks</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="../../ai/ai.html"><strong aria-hidden="true">24.</strong> AI</a></li><li class="chapter-item expanded "><a href="../../standards/standards.html"><strong aria-hidden="true">25.</strong> Standards</a></li><li class="chapter-item expanded "><a href="../../other/other.html"><strong aria-hidden="true">26.</strong> Other</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../other/templates/templates.html"><strong aria-hidden="true">26.1.</strong> Templates</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../other/templates/security-assessment-template.html"><strong aria-hidden="true">26.1.1.</strong> Security-assessment-template</a></li><li class="chapter-item "><a href="../../other/templates/risk-assessment-template-ics.html"><strong aria-hidden="true">26.1.2.</strong> Risk-assessment-template-ICS</a></li><li class="chapter-item "><a href="../../other/templates/risk-assessment-template-iso.html"><strong aria-hidden="true">26.1.3.</strong> Risk-assessment-template-ISO</a></li><li class="chapter-item "><a href="../../other/templates/risk-assessment-template-mobile.html"><strong aria-hidden="true">26.1.4.</strong> Risk-assessment-template-Mobile</a></li></ol></li><li class="chapter-item "><a href="../../other/regulations.html"><strong aria-hidden="true">26.2.</strong> Regulations</a></li><li class="chapter-item "><a href="../../other/assessment-steps.html"><strong aria-hidden="true">26.3.</strong> AssessmentSteps</a></li><li class="chapter-item "><a href="../../other/interview.html"><strong aria-hidden="true">26.4.</strong> Interview</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><a href="../../attack/attack.html"><strong aria-hidden="true">27.</strong> Attack</a></li><li class="chapter-item expanded "><a href="../../risks/risks.html"><strong aria-hidden="true">28.</strong> Risks</a></li><li class="spacer"></li><li class="chapter-item expanded "><a href="../../WebSites.html"><strong aria-hidden="true">29.</strong> WebSites</a></li><li class="chapter-item expanded "><a href="../../Glossery.html"><strong aria-hidden="true">30.</strong> Glossery</a></li><li class="chapter-item expanded "><a href="../../Reference.html"><strong aria-hidden="true">31.</strong> Reference</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">cysec-all-in-one(A.R)</h1>

                    <div class="right-buttons">
                        <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/armanriazi/cysec-all-in-one/tree/main/workspace" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/armanriazi/cysec-all-in-one/edit/main/workspace/./workspace//linux/ubuntu/iptable.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="iptables"><a class="header" href="#iptables">IPTables</a></h1>
<pre><code class="language-bash"># List all IPTables rules without numerical output
iptables -nvL

# Add a rule to reject packets from a specific IP
iptables -A INPUT -s 192.168.12.139 -j REJECT

# List all IPTables rules with line numbers
iptables -L --line-number

# Delete the first rule in the INPUT chain
iptables -D INPUT 1

# Verify the changes
iptables -nvL

# Replace the first rule in the INPUT chain with an ACCEPT rule
iptables -R INPUT 1 -j ACCEPT

# Verify the changes again
iptables -nvL

# Save the current IPTables configuration to a file
iptables-save &gt; /etc/iptables.conf

# Restore IPTables rules from the saved file
iptables-restore &lt; /etc/iptables.conf
</code></pre>
<h4 id="iptables-persistence"><a class="header" href="#iptables-persistence">IPTables Persistence</a></h4>
<pre><code class="language-bash"># Search for iptables-persistent package
aptitude search iptables-persistent

# Edit the persistent IPTables rules file
nano /etc/iptables/rules.v4

# List current IPTables rules
iptables -L
</code></pre>
<h3 id="explanation-of-iptables-commands"><a class="header" href="#explanation-of-iptables-commands">Explanation of IPTables Commands</a></h3>
<ol>
<li>
<p><code>iptables -nvL</code>: Lists all IPTables rules with numeric values and doesn’t show interfaces.</p>
</li>
<li>
<p><code>iptables -A INPUT -s 192.168.12.139 -j REJECT</code>: Adds a rule to the INPUT chain that rejects packets from the specified IP address.</p>
</li>
<li>
<p><code>iptables -L --line-number</code>: Displays IPTables rules with line numbers for easy reference.</p>
</li>
<li>
<p><code>iptables -D INPUT 1</code>: Deletes the first rule in the INPUT chain.</p>
</li>
<li>
<p><code>iptables -R INPUT 1 -j ACCEPT</code>: Replaces the first rule in the INPUT chain with an ACCEPT rule.</p>
</li>
<li>
<p><code>iptables-save &gt; /etc/iptables.conf</code>: Saves the current IPTables configuration to a file named /etc/iptables.conf.</p>
</li>
<li>
<p><code>iptables-restore &lt; /etc/iptables.conf</code>: Restores IPTables rules from the previously saved file.</p>
</li>
<li>
<p><code>aptitude search iptables-persistent</code>: Searches for packages related to persistent IPTables rules.</p>
</li>
<li>
<p><code>nano /etc/iptables/rules.v4</code>: Edits the file containing persistent IPTables rules.</p>
</li>
<li>
<p><code>iptables -L</code>: Lists all current IPTables rules.</p>
</li>
</ol>
<h3 id="example-iptables-configuration"><a class="header" href="#example-iptables-configuration">Example IPTables Configuration</a></h3>
<p>The example configuration file shows several common rules:</p>
<ul>
<li><code>:INPUT ACCEPT [15:1380]</code>: Sets the default policy for INPUT to ACCEPT.</li>
<li><code>:FORWARD ACCEPT [0:0]</code>: Sets the default policy for FORWARD to ACCEPT.</li>
<li><code>:OUTPUT ACCEPT [3:444]</code>: Sets the default policy for OUTPUT to ACCEPT.</li>
<li><code>-A OUTPUT -d facebook.com -j DROP</code>: Drops packets destined for facebook.com.</li>
<li><code>-A OUTPUT -p tcp --dport 22 -j DROP</code>: Drops TCP traffic on port 22 (SSH).</li>
<li><code>-A INPUT -p tcp -m multiport --dports 80,443 -j ACCEPT</code>: Accepts TCP traffic on ports 80 and 443.</li>
<li><code>-A INPUT -p icmp eth0 -j REJECT</code>: Rejects ICMP traffic on interface eth0.</li>
<li><code>-A INPUT -p tcp -j REJECT</code>: Rejects all other TCP traffic.</li>
</ul>
<p>This configuration demonstrates various filtering techniques, including:</p>
<ul>
<li>Blocking specific domains (facebook.com)</li>
<li>Disallowing SSH access</li>
<li>Allowing HTTP/HTTPS traffic</li>
<li>Rejecting ICMP traffic</li>
<li>Rejecting all other TCP traffic</li>
</ul>
<p>Remember to adjust these rules according to your specific security requirements and network setup. Always test changes in a controlled environment before applying them to production systems.</p>
<p>Thank you for providing the additional content about IPTables. I’ll correct and fix errors, elaborate on the commands, and provide explanations for each part. Here’s the corrected and expanded version:</p>
<pre><code class="language-sh"># Example of DROP
iptables -A INPUT -p tcp --dport 22 -j DROP

# Example of REJECT
iptables -A INPUT -p tcp --dport 23 -j REJECT --reject-with tcp-reset
</code></pre>
<p>In summary, the choice between <code>DROP</code> and <code>REJECT</code> depends on your desired behavior for handling unwanted packets:</p>
<ul>
<li><code>DROP</code>: Silently discards packets without sending a response.</li>
<li><code>REJECT</code>: Sends an ICMP error message back to the sender.</li>
</ul>
<pre><code class="language-bash"># Enable IP forwarding
echo &quot;1&quot; &gt; /proc/sys/net/ipv4/ip_forward
</code></pre>
<pre><code class="language-bash"># Set up port redirection
iptables -t nat -A PREROUTING -p tcp --dport 22 -j REDIRECT --to-port 2222
</code></pre>
<pre><code class="language-bash"># Display routing table
ip route

# Display network interface configuration
ifconfig

# Display IPv4 addresses
ip addr

# Save IPTables configuration
sudo iptables-save

# List IPTables rules
sudo iptables -L

# List IPTables rules with line numbers
sudo iptables -L --line-numbers

# Delete the third rule in the INPUT chain
sudo iptables -D INPUT 3

# Add a route (note: syntax error corrected)
sudo ip route add 10.0.0.0/8 via 192.168.12.100

# Check if kube-dns service is allowed
iptables-save | grep kube-dns

# Restart networking service
sudo systemctl restart networking

# Check if port 2375 is open
netstat -nap | grep :2375

# Allow port 5000 through UFW firewall
sudo ufw allow 5000

# Display eth0 interface configuration
ifconfig eth0

# List IPTables rules (corrected syntax)
iptables -L | more

# List NAT rules
iptables -L -n -v -t nat
</code></pre>
<pre><code class="language-bash"># Save IPTables configuration to a file
sudo iptables-save &gt; /etc/iptables.conf

# Restore IPTables configuration from a file
sudo iptables-restore &lt; /etc/iptables.conf
</code></pre>
<h3 id="explanation-of-iptables-commands-1"><a class="header" href="#explanation-of-iptables-commands-1">Explanation of IPTables Commands</a></h3>
<ol>
<li>
<p><code>iptables -A INPUT -p tcp --dport 22 -j DROP</code>: Adds a rule to drop all incoming TCP traffic on port 22 (SSH).</p>
</li>
<li>
<p><code>iptables -A INPUT -p tcp --dport 23 -j REJECT --reject-with tcp-reset</code>: Adds a rule to reject incoming TCP traffic on port 23 (Telnet) and sends a reset packet back to the sender.</p>
</li>
<li>
<p><code>echo &quot;1&quot; &gt; /proc/sys/net/ipv4/ip_forward</code>: Enables IP forwarding, allowing the system to act as a router.</p>
</li>
<li>
<p><code>iptables -t nat -A PREROUTING -p tcp --dport 22 -j REDIRECT --to-port 2222</code>: Sets up port redirection from port 22 to port 2222.</p>
</li>
<li>
<p><code>ip route</code>, <code>ifconfig</code>, <code>ip addr</code>: Display network routing information and interface configurations.</p>
</li>
<li>
<p><code>sudo iptables-save</code> and <code>sudo iptables -L</code>: Save and list IPTables rules.</p>
</li>
<li>
<p><code>sudo iptables -L --line-numbers</code>: Lists IPTables rules with line numbers for easy reference.</p>
</li>
<li>
<p><code>sudo iptables -D INPUT 3</code>: Deletes the third rule in the INPUT chain.</p>
</li>
<li>
<p><code>sudo ip route add 10.0.0.0/8 via 192.168.12.100</code>: Adds a routing entry for the 10.0.0.0/8 network via the gateway 192.168.12.100.</p>
</li>
<li>
<p><code>iptables-save | grep kube-dns</code>: Searches for rules related to the kube-dns service.</p>
</li>
<li>
<p><code>sudo systemctl restart networking</code>: Restarts the networking service.</p>
</li>
<li>
<p><code>netstat -nap | grep :2375</code>: Checks if port 2375 is open.</p>
</li>
<li>
<p><code>sudo ufw allow 5000</code>: Allows traffic through UFW firewall for port 5000.</p>
</li>
<li>
<p><code>ifconfig eth0</code>: Displays configuration for the eth0 interface.</p>
</li>
<li>
<p><code>iptables -L | more</code>: Lists IPTables rules with pagination.</p>
</li>
<li>
<p><code>iptables -L -n -v -t nat</code>: Lists NAT-related IPTables rules.</p>
</li>
<li>
<p><code>sudo iptables-save &gt; /etc/iptables.conf</code>: Saves IPTables configuration to a file named /etc/iptables.conf.</p>
</li>
<li>
<p><code>sudo iptables-restore &lt; /etc/iptables.conf</code>: Restores IPTables configuration from the saved file.</p>
</li>
</ol>
<p>These commands demonstrate various IPTables operations including rule creation, viewing, saving, restoring, and modifying. Remember to be cautious when modifying firewall rules, especially in production environments, and always test changes in a controlled manner.</p>
<p>Citations:
[1] <a href="https://todisco.de/en/blog/iptables-reject-vs-drop">https://todisco.de/en/blog/iptables-reject-vs-drop</a>
[2] <a href="https://serverfault.com/questions/157375/reject-vs-drop-when-using-iptables">https://serverfault.com/questions/157375/reject-vs-drop-when-using-iptables</a>
[3] <a href="https://www.baeldung.com/linux/iptables-reject-vs-drop">https://www.baeldung.com/linux/iptables-reject-vs-drop</a>
[4] <a href="https://forum.openwrt.org/t/iptables-difference-between-drop-and-reject/64738">https://forum.openwrt.org/t/iptables-difference-between-drop-and-reject/64738</a>
[5] <a href="https://bobcares.com/blog/iptables-drop-vs-reject/">https://bobcares.com/blog/iptables-drop-vs-reject/</a>
[6] <a href="https://unix.stackexchange.com/questions/109459/is-it-better-to-set-j-reject-or-j-drop-in-iptables">https://unix.stackexchange.com/questions/109459/is-it-better-to-set-j-reject-or-j-drop-in-iptables</a>
[7] <a href="https://medium.com/@turgenev.e9g/drop-vs-reject-how-to-make-linux-behave-like-windows-93e8df1be519">https://medium.com/@turgenev.e9g/drop-vs-reject-how-to-make-linux-behave-like-windows-93e8df1be519</a>
[8] <a href="https://www.coresentinel.com/reject-versus-drop/">https://www.coresentinel.com/reject-versus-drop/</a>
[9] <a href="https://ale.ale.narkive.com/CNOcwe66/iptables-drop-vs-reject-reject-with-tcp-reset">https://ale.ale.narkive.com/CNOcwe66/iptables-drop-vs-reject-reject-with-tcp-reset</a>
[10] <a href="http://www.chiark.greenend.org.uk/~peterb/network/drop-vs-reject">http://www.chiark.greenend.org.uk/~peterb/network/drop-vs-reject</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../linux/ubuntu/network.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../linux/ubuntu/os.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../linux/ubuntu/network.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../linux/ubuntu/os.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>



        <script>
            window.playground_line_numbers = true;
        </script>

        <script>
            window.playground_copyable = true;
        </script>

        <script src="../../ace.js"></script>
        <script src="../../editor.js"></script>
        <script src="../../mode-rust.js"></script>
        <script src="../../theme-dawn.js"></script>
        <script src="../../theme-tomorrow_night.js"></script>

        <script src="../../elasticlunr.min.js"></script>
        <script src="../../mark.min.js"></script>
        <script src="../../searcher.js"></script>

        <script src="../../clipboard.min.js"></script>
        <script src="../../highlight.js"></script>
        <script src="../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
